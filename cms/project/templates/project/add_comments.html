
{% extends 'project/base.html'%} <!-- use the base file -->
{% load static %}
    {% block head %}
         <link rel="stylesheet" href="{% static 'css/custom.css' %}">
    {% endblock %}
    
{% block content %} <!-- content of all web pages go -->

{% if user.is_authenticated %}
    {% if user == project.adviser %} 
        <h1> Add Project Comments </h1> <br/> 
        <!--logged in user can be called by
        "user" which is already valid for every page -->
        {% comment %} Logged In user: {{ user }}
            
        <br/>   
        Adviser : {{ project.adviser }} {% endcomment %}
        <!-- use form rendered from views -->
        
        <!-- put the data from the form.
        solution is put an instance of project-->

         <!-- Display form errors -->
         {% if form.errors %}
         <div class="alert alert-danger">
             <ul>
                 {% for error in form.non_field_errors %}
                     <li>{{ error }}</li>
                 {% endfor %}
                 {% for field in form %}
                     {% for error in field.errors %}
                         <li> Please Fix Errors in {{ field.label }} Field </li>
                     {% endfor %}
                 {% endfor %}
             </ul>
         </div>
         {% endif %}

        <form action="" method="POST" id="addCommentsForm"> 
            {% csrf_token %}
            {{ form.as_p }}
            
            <br/> 
            <input type="submit" value="Update"
            class="btn btn-secondary"> 
        {% else %}
            <h2> Access Denied! </h2> 
            <p> Only the Project's Adviser can update this project...</p>
            Logged In user: {{ user }}
                
            <br/>   
            Adviser : {{ project.adviser }}
        {% endif %} 
{% else %}
    <h1> Sorry! You must be Logged In to view This Page... </h1> 

    <a href="{% url 'login' %}">Login Here! </a> 

{% endif %}
 
<script>
    document.getElementById('addCommentsForm').onsubmit = function() {
        // Enable the proponents and adviser fields before submitting the form
        document.querySelector('input[name="title"]').removeAttribute('disabled');
        document.querySelector('select[name="project_type"]').removeAttribute('disabled');
        document.querySelector('select[name="proponents"]').removeAttribute('disabled');
        document.querySelector('select[name="adviser"]').removeAttribute('disabled');
        document.querySelector('textarea[name="description"]').removeAttribute('disabled');
        document.querySelector('select[name="panel"]').removeAttribute('disabled');
    };
</script>

{% endblock %}