{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'images/user.jpg' %}">
    <link rel="stylesheet" href="{% static 'css/free_sched_style.css' %}">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
    <script src="{% static 'js/custom.js' %}"></script>
    
    <title>Senior Project App</title>
  
    {% block styles %}{% endblock %}

    
  </head>
  <body class="body">
    <div class="wrapper">
      <div class="top_navbar">
        <div class="hamburger">
           <div class="hamburger__inner">
             <div class="one"></div>
             <div class="two"></div>
             <div class="three"></div>
           </div>
        </div>
        <div class="menu"> <!-- hero -->
          <div class="logo">
            <a href="{% url 'home' %}" style="text-decoration: none; color: inherit;">SP Management System</a>
          </div>
          {% if user.is_authenticated%}

            <div class="right_menu">
                <ul>
                <!-- Add notification icon/link -->
            
                  <li> <a href="{% url 'notifications' %}"> <i class="fas fa-bell icon icon-margin"></i>  <span class="notification-badge" id="notification-count">0</span>Notifications </a> </li>
                  <li> <a href="#">Features</a> </li>
                  <li> <a href="#">About</a> </li>
                  <li> <a href="#">Contact</a> </li>
                  
                    {% comment %} 
                  <li><i class="fas fa-user"></i>
                    <div class="">
                      <div class="">Profile</div>
                      <div class="dd_item">Change Password</div>
                      <div class="dd_item"><a href="{% url 'logout' %}" style="text-decoration: none; color: inherit;"><i class="fas fa-sign-out-alt"></i> Logout</a></div>
                    </div>
                  </li> {% endcomment %}
                </ul>
                  <img src="https://i.imgur.com/Ctwf8HA.png" alt="profile_pic" class="user-pic" onclick="toggleMenu()">
            
                  <div class="sub-menu-wrap" id="subMenu"> 
                    <div class="sub-menu">
                      <div class="user-info"> 
                        <img src="https://i.imgur.com/Ctwf8HA.png" alt="profile_pic" class="user-pic">
                          <h3> {{ request.user.first_name }} {{ request.user.last_name }}</h3>
                      </div> 
                      <hr>
                        <a href="#" class="sub-menu-link">
                          <p> Edit Profile </p>
                          <span>> </span>
                        </a> 

                        <a href="#" class="sub-menu-link">
                          <p> Edit Profile </p>
                          <span>></span>
                        </a> 

                        <a href="#" class="sub-menu-link">
                          <p> Edit Profile </p>
                          <span>></span>
                        </a> 

                    </div>
                  </div>
              </div>
          {% endif %}
        </div>
        </div>
      </div>
    
    {% comment %} <div class="d-flex justify-content-between align-items-center">
      {% include 'project/navbar.html' %} {% endcomment %}

      {% comment %} {% if user.is_authenticated %}
        <div class="usecdr-designation d-flex align-items-center p-2 bg-light rounded shadow-sm position-fixed bottom-0 end-0 m-3">
          <span class="me-2 fw-bold">Logged in as:</span>
          <span>{{ user.get_full_name }}</span>
          
          {% if user.get_role_display == "Coordinator" and not user.is_current_coordinator %}
              <span class="text-danger ms-2">(Former Coordinator)</span>
          {% else %}
              <span class="text-muted ms-2">({{ user.get_role_display }})</span>
          {% endif %}
            
        </div>
      {% endif %} {% endcomment %}
    </div> 
    
      <div class="main_container">
          <div class="row">

  <!-- Include the sidebar here -->
   <div class=sidebar> 
      {% include 'project/sidebar.html' %}
    <div> 

      {% if messages %}
        <div class="alert-container">
          {% for message in messages %}
            <div class="alert alert-dismissible fade show {% if message.tags %}alert-{{ message.tags }}{% endif %}" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        </div> 
      {% endif %}
    
      <div class="container max:width=none;">
        {% block content %} <!-- content of all web pages go -->
        {% endblock %}
      </div>

     </div> 
  </div> 
        <br/> 
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
    {% csrf_token %}
    
    <script src="{% static 'js/notifications.js' %}"></script>

    <script>
      let subMenu = document.getElementById("subMenu"); 

      function toggleMenu(){
        subMenu.classList.toggle("open-menu"); 
      } 

      $(document).ready(function() {
      
        // Initial setup - collapse the sidebar when the page loads
        $(".wrapper").addClass("active");
        $(".sidebar").css("width", "80px"); // Collapse sidebar width initially
        $(".profile_info, .sidebar-link-text, .sidebar-menu-text").hide(); // Hide text initially
        $(".container").css("margin-left", "100px");

        let subMenu = document.getElementById("subMenu"); 

        function toggleMenu(){
          subMenu.classList.toggle("open-menu")
        }
        
        // Toggle class on hamburger click (optional, manual toggle)
        $(".hamburger .hamburger__inner").click(function() {
          $(".wrapper").toggleClass("active");
          if ($(".wrapper").hasClass("active")) {
            // Collapse sidebar - hide text content
            
            $(".sidebar").css("width", "80px");
            $(".profile_info").fadeOut(200);
            $(".sidebar-link-text").fadeOut(200);
            $(".sidebar-menu-text").fadeOut(200);
            $(".container").css("margin-left", "80px");
            
          } else {
            // Expand sidebar - show text content
            $(".sidebar").css("width", "300px");
            $(".profile_info").fadeIn(200);
            $(".sidebar-link-text").fadeIn(200);
            $(".sidebar-menu-text").fadeIn(200);
            $(".container").css("margin-left", "100px");
          }
        });
    
        // Hover to expand and collapse sidebar
        $(".sidebar").hover(
          function() {
            // When the sidebar is hovered over, expand it
            $(".wrapper").removeClass("active"); // Expand sidebar
            $(".sidebar").css("width", "300px");
            $(".profile_info").fadeIn(200);
            $(".sidebar-link-text").fadeIn(200);
            $(".sidebar-menu-text").fadeIn(200);
            $(".container").css("margin-left", "100px");
             // Show dropdown arrows
          },
          function() {
            // When the hover is removed, collapse it
            if (!$(".wrapper").hasClass("active")) {
              $(".wrapper").addClass("active"); // Collapse sidebar
              $(".sidebar").css("width", "80px");
              $(".profile_info").fadeOut(200);
              $(".sidebar-link-text").fadeOut(200);
              $(".sidebar-menu-text").fadeOut(200);
              $(".container").css("margin-left", "80px");
              // Hide dropdown arrows when collapsed
              }
          }
          
        );
        // Optional: Handle the dropdown toggle
      });
    </script>
  </body>
</html>

