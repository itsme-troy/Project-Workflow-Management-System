{% extends 'project/base.html' %}
{% load static %}

    <!-- ===== ===== Remix Font Icons Cdn ===== ===== -->
    <link rel="stylesheet" href="fonts/remixicon.css">
    {% block content %}
    
    <div class="grid-container">
        <!-- User Profile Section -->
        <section class="pic-skills-column">
            <subsection class="userProfile card">
                <div class="profile_container">
                    {% if student.profile_image and student.profile_image.url != '/media/static/images/default_profile_pic.jpg' %}
                        <figure><img src="{{ student.profile_image.url }}" alt="profile_pic" class="img-fluid" width="250px" height="250px"></figure>
                    {% else %}
                        <figure><img src="{% static '/images/default_profile_pic.jpg' %}" class="img-fluid" width="250px" height="250px"></figure>
                    {% endif %}
                </div>
            </subsection>
        
            <subsection class="skills card">
                <div class="skills_container">
                    <h1 class="heading skills-heading">Skills</h1>
                    <ul class="skills-list">
                        <li>Android</li>
                        <li>Web-Design</li>
                        <li>UI/UX</li>
                        <li>Video Editing</li>
                    </ul>
                </div>
            </subsection>
        </section>

        <!-- User Details Section -->
        <section class="details-info-column">
            <subsection class="user_details card">
                <div class="header-container">
                    <div class="UserName">
                        <h1 class="name">{{ student.first_name}} {{ student.last_name }}</h1>
                        <span class="role {{ student.role|lower }}">{{ student.role }}</span> 
                    </div>
                    <div class="button-container" style="display: flex; gap: 10px;">  <!-- Using gap to space out buttons -->
                        <a href="javascript:history.back()" class="btn btn-outline-secondary btn-sm">Back</a>
                        {% if request.user.id == student.id %}
                            <a href="{% url 'update-user' %}" class="btn btn-outline-secondary btn-sm">Edit Profile</a> <!-- Edit Profile Button -->
                        {% endif %}
                    </div>
                </div>
               
                <div class="bio-section" style="margin-top: 20px;">
                    <h4 class="text-center">About Me:</h4>
                    <p>{{ student.bio }}</p> <!-- Displaying the bio content -->
                </div>
                
            </subsection>
            
            <!-- Additional Information Section -->
            <subsection class="additional_information card">
                
                <div class="toggle-container" style="display: flex; justify-content: flex-start; margin-bottom: 10px;">
                    <button id="aboutButton" onclick="toggleVisibility('aboutInfo', this)" class="toggle-button active-toggle" style="background-color: #4CAF50;">About</button>
                    <button id="projectGroupButton" onclick="toggleVisibility('projectGroup', this)" class="toggle-button" style="margin-left: 10px;">Project Group</button>
                    {% comment %} <div class="underline-indicator" id="underline" style="width: 50px; left: 0;"></div> <!-- Underline indicator --> {% endcomment %}
                </div>

                <div id="aboutInfo" style="display:block;">  <!-- Changed to display:block -->
                    <h3 class="heading"> About </h3>
                    <table class="contact-info-table">
                        <tr>
                            <td><strong class="contact-label">Student ID:</strong></td>
                            <td>{{ student.student_id }}</td>
                        </tr>
                        <tr>
                            <td><strong class="contact-label">Phone:</strong></td>
                            <td>{{ student.phone }}</td>
                        </tr>
                        <tr>
                            <td><strong class="contact-label">Course:</strong></td>
                            <td>{{ student.course }}</td>
                        </tr>
                        <tr>
                            <td><strong class="contact-label">Gbox:</strong></td>
                            <td>{{ student.email }}</td>
                        </tr>
                        <tr>
                            <td><strong class="contact-label">Facebook link:</strong></td>
                            <td>{{ student.facebook_link }}</td>
                        </tr>
                    </table>
                </div>
              
                <div id="projectGroup" style="display:none;">  <!-- Remains display:none -->
                    <h3>Project Group</h3>
                    <div class="project-cards-container">
                        {% if not project_group %}
                            <p class="no-projects-message">No Project Group available at the moment.</p>
                        {% else %}
                            {% for group in project_group %}
                                <div class="card mb-3 project-card" style="width: 18rem;">
                                       
                                        {% comment %} <div class="card-header">
                                            Adviser:x``
                                        </div> {% endcomment %}

                                    <ul class="list-group list-group-flush">
                                        {% for student in group.proponents.all %}
                                            <li class="list-group-item">{{ student }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endfor %}
                        {% endif %}
                </div> 
                    {% comment %} <a href="{% url 'update-user' %}" class="btn btn-secondary mt-3">Update Profile</a> {% endcomment %}
            </subsection>
        </section>
    </div>

    <script>
        function toggleVisibility(id, button) {
            var aboutInfo = document.getElementById('aboutInfo');
            var projectGroup = document.getElementById('projectGroup');
            var underline = document.getElementById('underline');
        
            // Reset button styles
            document.getElementById('aboutButton').style.backgroundColor = '';
            document.getElementById('projectGroupButton').style.backgroundColor = '';
            document.getElementById('aboutButton').classList.remove('active-toggle'); // Remove active class
            document.getElementById('projectGroupButton').classList.remove('active-toggle'); // Remove active class
        
            if (id === 'aboutInfo') {
                aboutInfo.style.display = "block";
                projectGroup.style.display = "none"; // Hide project group
                button.style.backgroundColor = '#4CAF50'; // Highlight active button
                button.classList.add('active-toggle'); // Add active class
                underline.style.left = button.offsetLeft + 'px'; // Move underline to About button
                underline.style.width = button.offsetWidth + 'px'; // Adjust underline width
            } else if (id === 'projectGroup') {
                projectGroup.style.display = "block";
                aboutInfo.style.display = "none"; // Hide about info
                button.style.backgroundColor = '#4CAF50'; // Highlight active button
                button.classList.add('active-toggle'); // Add active class
                underline.style.left = button.offsetLeft + 'px'; // Move underline to Project Group button
                underline.style.width = button.offsetWidth + 'px'; // Adjust underline width
            }
        }
        // To set the default view on page load
        window.onload = function() {
            toggleVisibility('aboutInfo', document.getElementById('aboutButton'));
        }
    </script>
{% endblock %}