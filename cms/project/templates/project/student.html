{% extends 'project/base.html'%} <!-- use the base file -->
{% load static %}
{% load custom_filters %}
{% block content %} <!-- content of all web pages go -->

        <h1 class="text-center my-4">Student List</h1> <br/>

        <div class="btn-group" role="group" aria-label="Student Filter">
            <button type="button" class="btn btn-secondary" onclick="filterStudents('all')">All Students</button>
            <button type="button" class="btn btn-secondary" onclick="filterStudents('eligible')">Eligible Students</button>
            <button type="button" class="btn btn-secondary" onclick="filterStudents('ineligible')">Students on Waitlist</button>
        </div>

    <div class="table-responsive"> <br/> 
        <table class="table table-hover table-bordered">
            <caption>List of Students</caption>
            <thead class="thead-dark">
                <tr>
                    <th scope="col"> # </th>
                    <th scope="col">Last Name</th>
                    <th scope="col">First Name</th>
                    <th scope="col">Email</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for student in student_list %}
                    {% if student.role == 'STUDENT' %}
                    <tr data-eligible="{{ student.eligible|yesno:'true,false' }}" {% if student == user %}class="table-warning"{% endif %}>
                            <td> <strong> {{ forloop.counter }} </strong> </td>
                            <td>{{ student.last_name }}</td>
                            <td>{{ student.first_name }}</td>
                            <td>{{ student.email }}</td>
                            <td>
                                <a href="{% url 'show-student' student.id %}">
                                    <button type="button" class="btn btn-outline-primary btn-sm">View Profile</button>
                                </a>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
        <hr/>

<!-- 
{{ students }} </br> 
Has Previous: {{ students.has_previous }} <br/> 
Has Next: {{ students.has_next }} <br/> 
Current Page: {{ students.number }} <br/> 
Number of Pages: {{ students.paginator.num_pages }} <br/> 
<hr><br/><br/> -->

{% comment %} <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">

    {% if students.has_previous %}
        <li class="page-item"><a class="page-link" href="?page=1">&laquo; First</a></li>
        <li class="page-item"><a class="page-link" href="?page={{students.previous_page_number}}">Previous</a></li>
    {% endif %}

 
    {% for i in nums %}
    <li class="page-item {% if forloop.counter == students.number %}disabled{% endif %}">
    <a class="page-link" href="?page={{forloop.counter}}">{{ forloop.counter }}</a>
</li>
    {% endfor %}
    {% if students.has_next %}
        <li class="page-item"> <a class="page-link" href="?page={{students.next_page_number}}">Next</a></li>
        <li class="page-item"> <a class="page-link" href="?page={{students.paginator.num_pages}}">Last &raquo;</a></li>
    {% endif %}
    
    <li class="page-item ml-auto disabled"><a href="#" class="page-link"> Page {{ students.number }} of {{ students.paginator.num_pages }} </a></li>

</ul>
</nav> {% endcomment %}
<script>
    function filterStudents(type) {
        const rows = document.querySelectorAll('tbody tr');
        const buttons = document.querySelectorAll('.btn-group .btn');

        // Remove 'active' class from all buttons
        buttons.forEach(button => button.classList.remove('active'));

        // Add 'active' class to the clicked button
        document.querySelector(`.btn-group .btn[onclick="filterStudents('${type}')"]`).classList.add('active');

        rows.forEach(row => {
            const isEligible = row.dataset.eligible === 'true';

            if (type === 'all') {
                row.style.display = '';
            } else if (type === 'eligible' && isEligible) {
                row.style.display = '';
            } else if (type === 'ineligible' && !isEligible) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }
</script>

{% endblock %}