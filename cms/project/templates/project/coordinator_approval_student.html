{% extends 'project/base.html'%} <!-- use the base file -->
{% load static %}
{% block content %} <!-- content of all web pages go -->


{% comment %} <div class="card">
    <div class="card-header">
      System Report  
    </div>
    <div class="card-body">
     <p class="card-text">Student Count: {{ student_count }} </p>
     <p class="card-text">Faculty Count: {{ faculty_count }} </p>
     <p class="card-text">Project Count: {{ project_count }}</p>
     <p class="card-text">Proposal Count: {{ proposal_count }} </p>
   
    </div>
  </div> </br> {% endcomment %}

  
  <a href="{% url 'coordinator-approval-faculty' %}" class="btn btn-primary">
    <i class="fas fa-chalkboard-teacher"></i> Go to Faculty Approval
</a> 

  <form action="" method=POST> 
    {% csrf_token %} 

    <center>
    <h1 style="display: inline-block;"> Student Eligibility Approval Form </h1> 
    <div class="text-end" style="margin-left: 20px; float: right;"> <!-- Changed to float right -->
        <button class="btn btn-success" type="submit">Save All Changes</button>
    </div> </center> 


<table class="table table-hover table-bordered">  
    <thead> 
        <tr> 
            <th scope="col"> # </th> 
            <th scope="col"> Last Name </th> 
            <th scope="col"> First Name </th> 
            <th scope="col" onclick="toggleAllCheckboxes()"> Eligibility 
                <span class="hint-button" title="Click to toggle eligibility checkboxes">?</span>
            </th> 
            <th> Actions </th>
            
            {% comment %} <th scope="col"> Eligibility Deficiencies  </th>  {% endcomment %}
        </tr> 
    </thead>  
    <tbody>

    {% for student in student_list %} 

        <tr onclick="toggleActions(this)">
            <td><strong> {{ forloop.counter }} </strong></td>
            <td> {{ student.last_name }} </td> 
            <td> {{ student.first_name }} </td>
            <td>
                <div class="form-check" style="display: none;"> 
                    <input class="form-check-input"
                        type="checkbox" 
                        {% if student.eligible %} checked="checked" {% endif %}
                        value={{student.id}} 
                        name="student_box">
                </div> 
            </td>
            <td>  
                <span class="hint-button" onclick="showActions(this)">Click row to show actions</span>   
                <div class="action-buttons small-btn" style="display: none;">

                    <a href="{% url 'delete-user' student.id %}" onclick="return confirm('Are you sure you want to delete this account?');">
                    <button type="button" class="btn btn-outline-danger btn-sm">Delete </button> </a>  </td>
                </div> 
                    {% comment %} <td> {{ student.eligibilty_deficiencies }}</td> 
            <td> <a href="{% url 'update_deficiencies' 'student.id' %}" > Update </a>  </td>  {% endcomment %}
        </tr>
       
    {% endfor %}
    </tbody> 
</table>
<p class="help-text text-end">Click the "Eligibility" column header to display checkboxes.</p>


<script>
    
    function toggleAllCheckboxes() {
        const checkboxDivs = document.querySelectorAll('.form-check');
        checkboxDivs.forEach(div => {
            div.style.display = (div.style.display === 'none') ? 'block' : 'none';
        });
    }

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });

    // Example of form validation
    document.querySelector('form').addEventListener('submit', function(e) {
        const checkboxes = document.querySelectorAll('input[name="student_box"]:checked');
        if (checkboxes.length === 0) {
            e.preventDefault();
            alert('Please select at least one student.');
        }
    });

    function toggleActions(row) {
        // Remove active class from all rows
        document.querySelectorAll('tr').forEach(tr => tr.classList.remove('active'));
        // Add active class to clicked row
        row.classList.add('active');
    }

    function showActions(hintButton) {
        // Hide all hint buttons and show action buttons
        document.querySelectorAll('.hint-button').forEach(btn => btn.style.display = 'inline');
        document.querySelectorAll('.action-buttons').forEach(btns => btns.style.display = 'none');

        // Show the action buttons for the clicked row and hide the hint button
        hintButton.style.display = 'none';
        hintButton.nextElementSibling.style.display = 'block'; // Show action buttons
    }

    // Add click handler to close rows when clicking outside
    document.addEventListener('click', function(event) {
        if (!event.target.closest('tr')) {
            document.querySelectorAll('tr').forEach(tr => tr.classList.remove('active'));
            // Reset hint buttons and action buttons
            document.querySelectorAll('.hint-button').forEach(btn => btn.style.display = 'inline');
            document.querySelectorAll('.action-buttons').forEach(btns => btns.style.display = 'none');
        }
    });

</script><style>
    table {
        min-height: 500px; /* Ensures a minimum height */
    }
    table td {
        padding: 20px; /* Increase cell spacing */
    }

    
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .btn-success {
        background-color: #28a745;
        border: none;
        color: white;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .btn-success:hover {
        background-color: #218838;
    }

    .table-hover tbody tr:hover {
        background-color: #f1f1f1;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f9f9f9;
    }

    .card {
        border: 1px solid #ccc;
        border-radius: 8px;
        margin: 20px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .card-header {
        font-weight: bold;
        font-size: 18px;
        margin-bottom: 10px;
    }

    .hint-button {
        display: inline-block;
        padding: 5px 10px;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .hint-button:hover {
        background-color: #e0e0e0;
    }

    .help-text {
        margin-top: 10px;
        font-size: 14px;
        color: #555;
    }

    @media (max-width: 768px) {
        .table {
            width: 100%;
            overflow-x: auto;
            display: block;
        }
    }
</style>
{% endblock %}